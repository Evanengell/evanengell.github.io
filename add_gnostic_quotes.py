#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""–î–æ–¥–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω—ñ –≥–Ω–æ—Å—Ç–∏—á–Ω—ñ —Ü–∏—Ç–∞—Ç–∏ —É —Ñ—É—Ç–µ—Ä–∏ —Å—Ç–æ—Ä—ñ–Ω–æ–∫ —Ä–æ–∑–∫–ª–∞–¥—ñ–≤"""

import re
import os

# –ì–Ω–æ—Å—Ç–∏—á–Ω—ñ —Ü–∏—Ç–∞—Ç–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä–æ–∑–∫–ª–∞–¥—É
QUOTES = {
    'keltskyi-khrest': '–•—Ä–µ—Å—Ç ‚Äî –Ω–µ —Å–∏–º–≤–æ–ª —Å—Ç—Ä–∞–∂–¥–∞–Ω–Ω—è, –∞ –∫–ª—é—á –¥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è: —Ç–∞–º, –¥–µ –ø–µ—Ä–µ—Ç–∏–Ω–∞—é—Ç—å—Å—è —á–∞—Å —ñ –≤—ñ—á–Ω—ñ—Å—Ç—å, –Ω–∞—Ä–æ–¥–∂—É—î—Ç—å—Å—è —ñ—Å—Ç–∏–Ω–∞.',
    'golden-dawn': '–°–≤—ñ—Ç–ª–æ –ó–æ–ª–æ—Ç–æ–≥–æ –°—Ö–æ–¥—É —Ä–æ–∑–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –ª–∏—à–µ —Ç–∏–º, —Ö—Ç–æ –≥–æ—Ç–æ–≤–∏–π –ø–æ–±–∞—á–∏—Ç–∏ —Ç–µ–º—Ä—è–≤—É –≤ —Å–æ–±—ñ.',
    'try-karty': '–ú–∏–Ω—É–ª–µ, —Ç–µ–ø–µ—Ä—ñ—à–Ω—î, –º–∞–π–±—É—Ç–Ω—î ‚Äî —Ç—Ä–∏ —Ç–æ—á–∫–∏ —î–¥–∏–Ω–æ–≥–æ –∫–æ–ª–∞. –ü—ñ–∑–Ω–∞–π —ó—Ö —Ç–∞–Ω–µ—Ü—å, —ñ —á–∞—Å –∑—É–ø–∏–Ω–∏—Ç—å—Å—è.',
    'lyubovnyi-trykutnyk': '–°–ø—Ä–∞–≤–∂–Ω—è –ª—é–±–æ–≤ ‚Äî —Ü–µ –Ω–µ –∑–ª–∏—Ç—Ç—è –¥–≤–æ—Ö, –∞ —Ç–∞–Ω–æ–∫ —Ç—Ä—å–æ—Ö: –¢–∏, –Ü–Ω—à–∏–π —ñ –ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–µ –º—ñ–∂ –≤–∞–º–∏.',
    'odna-karta': '–Ü–Ω–æ–¥—ñ –æ–¥–Ω–µ –Ω–∞—Å—ñ–Ω–Ω—è –º—ñ—Å—Ç–∏—Ç—å –±—ñ–ª—å—à–µ —ñ—Å—Ç–∏–Ω–∏, –Ω—ñ–∂ —Ü—ñ–ª–∞ –∫–Ω–∏–≥–∞ —Å–ª—ñ–≤.',
    'derevo-zhyttya': '–ö–æ—Ä—ñ–Ω–Ω—è —Ç—è–≥–Ω–µ—Ç—å—Å—è –¥–æ –Ω–µ–±–∞, –∫—Ä–æ–Ω–∞ ‚Äî –¥–æ –∑–µ–º–ª—ñ. –£ –î–µ—Ä–µ–≤—ñ –ñ–∏—Ç—Ç—è –≤—Å–µ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–æ –¥–ª—è —Ç–∏—Ö, —Ö—Ç–æ –±–∞—á–∏—Ç—å –ª–∏—à–µ —Ñ–æ—Ä–º—É.',
    'sim-chakr': '–°—ñ–º –≤—Ä–∞—Ç, —Å—ñ–º –ø–µ—á–∞—Ç–æ–∫, —Å—ñ–º —Å–≤—ñ—Ç—ñ–≤. –í—ñ–¥–∫—Ä–∏–π —ó—Ö –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ ‚Äî —ñ –∑–Ω–∞–π–¥–µ—à –≤—ñ—Å—ñ–º –≤—Ä–∞—Ç—É –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–µ–±–µ.',
    'astrolohichne-kolo': '–ó–æ–¥—ñ–∞–∫ ‚Äî –Ω–µ –≤\'—è–∑–Ω–∏—Ü—è –¥–æ–ª—ñ, –∞ –∫–∞—Ä—Ç–∞ –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π. –ó—ñ—Ä–∫–∏ —Å—Ö–∏–ª—è—é—Ç—å, –∞–ª–µ –Ω–µ –ø—Ä–∏–º—É—à—É—é—Ç—å.',
    'dukhovnyi-rozvytok': '–î—É—Ö–æ–≤–Ω–∏–π —à–ª—è—Ö ‚Äî —Ü–µ –Ω–µ –ø—ñ–¥–π–æ–º –Ω–∞ –≤–µ—Ä—à–∏–Ω—É, –∞ —Å–ø—É—Å–∫ –¥–æ –¥–∂–µ—Ä–µ–ª–∞. –¢–∞–º, –≤–Ω–∏–∑—É, —á–µ–∫–∞—î —Å–≤—ñ—Ç–ª–æ.',
    'rozkryttia-taiemnytsi': '–¢–∞—î–º–Ω–∏—Ü—è —Ä–æ–∑–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –Ω–µ —Ç–æ–¥—ñ, –∫–æ–ª–∏ —ó—ó —Ä–æ–∑–≥–∞–¥—É—é—Ç—å, –∞ –∫–æ–ª–∏ –¥–æ –Ω–µ—ó –ø—Ä–∏–ø–∏–Ω—è—é—Ç—å —Å—Ç–∞–≤–∏—Ç–∏ –ø–∏—Ç–∞–Ω–Ω—è.',
    'detektyv': '–ù–∞–π–≥–ª–∏–±—à–∞ –ø—Ä–∞–≤–¥–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞ –Ω–µ –≤—ñ–¥ —Ç–µ–±–µ, –∞ –≤ —Ç–æ–±—ñ. –®—É–∫–∞–π —Å–ª—ñ–¥—á–æ–≥–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ.',
    'pryiniattia-rishennia': '–†—ñ—à–µ–Ω–Ω—è –≤–∂–µ –ø—Ä–∏–π–Ω—è—Ç–æ —É –≤—ñ—á–Ω–æ—Å—Ç—ñ. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ª–∏—à–µ –∑–≥–∞–¥–∞—Ç–∏ –π–æ–≥–æ —É —á–∞—Å—ñ.',
    'finansy-ta-hroshi': '–ó–æ–ª–æ—Ç–æ —Ç–µ—á–µ —Ç—É–¥–∏, –¥–µ —î –≤–Ω—É—Ç—Ä—ñ—à–Ω—î –±–∞–≥–∞—Ç—Å—Ç–≤–æ. –ù–∞–ø–æ–≤–Ω–∏ —á–∞—à—É –¥—É—Ö—É ‚Äî —ñ —Å—Ä—ñ–±–ª–æ –ø—Ä–∏–π–¥–µ —Å–∞–º–µ.',
    'zdorovya': '–¢—ñ–ª–æ ‚Äî —Ö—Ä–∞–º –¥—É—à—ñ, –∞–ª–µ –¥—É—à–∞ ‚Äî –¥–≤–µ—Ä—ñ –¥–æ —Ç–æ–≥–æ, —â–æ –ø–æ–∑–∞ —Ñ–æ—Ä–º–æ—é. –õ—ñ–∫—É–π –æ–±–∏–¥–≤–∞ –±–æ–∫–∏ –ø–æ—Ä–æ–≥–∞.',
    'stosunky': '–£ –≤—ñ–¥–Ω–æ—Å–∏–Ω–∞—Ö —Ç–∏ –∑—É—Å—Ç—Ä—ñ—á–∞—î—à –Ω–µ —ñ–Ω—à–æ–≥–æ, –∞ —Å–≤–æ—î –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è. –ü–æ–ª—é–±–∏ –π–æ–≥–æ ‚Äî —ñ —ñ–Ω—à–∏–π –∑–º—ñ–Ω–∏—Ç—å—Å—è.',
    'rik-poperedu': '–†—ñ–∫ ‚Äî —Ü–µ –∫–æ–ª–æ, –∞ –∫–æ–ª–æ –Ω–µ –º–∞—î –ø–æ—á–∞—Ç–∫—É. –ö–æ–∂–Ω–∞ –º–∏—Ç—å –º–æ–∂–µ —Å—Ç–∞—Ç–∏ –ù–æ–≤–∏–º –†–æ–∫–æ–º –¥–ª—è —Ç–æ–≥–æ, —Ö—Ç–æ –ø—Ä–æ–∫–∏–Ω—É–≤—Å—è.',
    'tyzhden-poperedu': '–°—ñ–º –¥–Ω—ñ–≤ ‚Äî —Å—ñ–º –Ω–æ—Ç. –°–ø—ñ–≤–∞–π —ó—Ö —Å–≤—ñ–¥–æ–º–æ, —ñ —Ç–∏–∂–¥–µ–Ω—å —Å—Ç–∞–Ω–µ —Å–∏–º—Ñ–æ–Ω—ñ—î—é –∑–∞–º—ñ—Å—Ç—å —à—É–º—É.',
    'den-narodzhennya': '–î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –¥—É—à—ñ –Ω–µ –∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ –¥–Ω–µ–º –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —Ç—ñ–ª–∞. –ó–Ω–∞–π–¥–∏ –ø–µ—Ä—à—É –¥–∞—Ç—É ‚Äî —ñ –ø—ñ–∑–Ω–∞—î—à –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è.',
    'tak-chy-ni': '–¢–∞–∫ —ñ –ù—ñ ‚Äî –¥–≤—ñ —Å—Ç–æ—Ä–æ–Ω–∏ –æ–¥–Ω—ñ—î—ó —ñ—Å—Ç–∏–Ω–∏. –ú—É–¥—Ä–∏–π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î "—Ç–∞–∫" —ñ "–Ω—ñ" –æ–¥–Ω–æ—á–∞—Å–Ω–æ.',
    'rozum-tilo-dukh': '–¢—Ä–∏ –≤ –æ–¥–Ω–æ–º—É, –æ–¥–Ω–µ –≤ —Ç—Ä—å–æ—Ö. –ö–æ–ª–∏ —Ä–æ–∑—É–º –∑–∞—Ç–∏—Ö–∞—î, —Ç—ñ–ª–æ —Ç–∞–Ω—Ü—é—î, –∞ –¥—É—Ö —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î ‚Äî –Ω–∞—Å—Ç–∞—î —Ü—ñ–ª—ñ–Ω—ñ—Å—Ç—å.',
    'pentahrama': '–ü\'—è—Ç–∏–∫—É—Ç–Ω–∞ –∑—ñ—Ä–∫–∞ ‚Äî —Å–∏–º–≤–æ–ª –ª—é–¥–∏–Ω–∏, —â–æ –ø—Ä–æ—Å—Ç—è–≥–ª–∞—Å—è –º—ñ–∂ –Ω–µ–±–æ–º —ñ –∑–µ–º–ª–µ—é. –¢–∏ ‚Äî –º—ñ—Å—Ç –º—ñ–∂ —Å–≤—ñ—Ç–∞–º–∏.',
    'prostyi-khrest': '–ü—Ä–æ—Å—Ç–æ—Ç–∞ ‚Äî –Ω–∞–π–≥–ª–∏–±—à–∞ —Ç–∞—î–º–Ω–∏—Ü—è. –£ —Ö—Ä–µ—Å—Ç—ñ —á–æ—Ç–∏—Ä—å–æ—Ö –Ω–∞–ø—Ä—è–º–∫—ñ–≤ —Ö–æ–≤–∞—î—Ç—å—Å—è –ø\'—è—Ç–∏–π ‚Äî —Ü–µ–Ω—Ç—Ä.',
    'pidkova': '–ü—ñ–¥–∫–æ–≤–∞ –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —â–∞—Å—Ç—è –Ω–µ —Ç–æ–º—É, —â–æ –∑–∞—Ö–∏—â–∞—î, –∞ —Ç–æ–º—É, —â–æ –Ω–∞–≥–∞–¥—É—î: —à–ª—è—Ö –∑–∞–≤–∂–¥–∏ –≤–µ–¥–µ –¥–æ–¥–æ–º—É.',
    'tetraktys': '–î–µ—Å—è—Ç—å —Ç–æ—á–æ–∫ –ø—ñ—Ñ–∞–≥–æ—Ä—ñ–π—Ü—ñ–≤ –º—ñ—Å—Ç—è—Ç—å –≤—Å—ñ —á–∏—Å–ª–∞ —ñ –≤—Å—ñ —Å–≤—ñ—Ç–∏. 1+2+3+4=10. –ü–æ—á–∞—Ç–æ–∫ —î –∫—ñ–Ω–µ—Ü—å.',
    'robota-ta-karyera': '–ü—Ä–∞—Ü—è ‚Äî –Ω–µ –ø—Ä–æ–∫–ª—è—Ç—Ç—è, –∞ —Ç–∞—ó–Ω—Å—Ç–≤–æ. –ö–æ–∂–Ω–∞ —Å–ø—Ä–∞–≤–∞, –≤–∏–∫–æ–Ω–∞–Ω–∞ —Å–≤—ñ–¥–æ–º–æ, —Å—Ç–∞—î –º–æ–ª–∏—Ç–≤–æ—é.',

    # –î–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–ª—è —Ñ–∞–π–ª—ñ–≤ –±–µ–∑ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –Ω–∞–∑–≤
    'career': '–Ü—Å—Ç–∏–Ω–Ω–∞ –∫–∞—Ä\'—î—Ä–∞ ‚Äî —Ü–µ –Ω–µ –ø—ñ–¥–π–æ–º –¥—Ä–∞–±–∏–Ω–æ—é, –∞ –ø–æ–≥–ª–∏–±–ª–µ–Ω–Ω—è –∫–æ–ª–æ–¥—è–∑—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–µ–±–µ.',
    'classic': '–ö–ª–∞—Å–∏—á–Ω–µ ‚Äî —Ü–µ —Ç–µ, —â–æ –ø–µ—Ä–µ–∂–∏–≤–∞—î —á–∞—Å, –±–æ –Ω–∞—Ä–æ–¥–∏–ª–æ—Å—è –ø–æ–∑–∞ –Ω–∏–º.',
    'forecast': '–ú–∞–π–±—É—Ç–Ω—î –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å ‚Äî –≤–æ–Ω–æ –≤–∂–µ —Ç—É—Ç, –ø—Ä–∏—Ö–æ–≤–∞–Ω–µ –≤ –Ω–∞—Å—ñ–Ω–Ω—ñ —Ç–µ–ø–µ—Ä—ñ—à–Ω—å–æ–≥–æ.',
    'love': '–õ—é–±–æ–≤ ‚Äî –Ω–µ –ø–æ—á—É—Ç—Ç—è, –∞ —Å–ø–æ—Å—ñ–± –±–∞—á–µ–Ω–Ω—è. –ó–∞–∫–æ—Ö–∞–Ω—ñ –±–∞—á–∞—Ç—å –æ–¥–∏–Ω –≤ –æ–¥–Ω–æ–º—É –ë–æ–≥–∞.',
    'quick': '–®–≤–∏–¥–∫—ñ—Å—Ç—å ‚Äî —ñ–ª—é–∑—ñ—è —á–∞—Å—É. –í –º–∏—Ç—Ç—î–≤–æ—Å—Ç—ñ —Ö–æ–≤–∞—î—Ç—å—Å—è –≤—ñ—á–Ω—ñ—Å—Ç—å.',
}

# –î–µ—Ñ–æ–ª—Ç–Ω–∞ —Ü–∏—Ç–∞—Ç–∞ –¥–ª—è —Ñ–∞–π–ª—ñ–≤ –±–µ–∑ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ—ó
DEFAULT_QUOTE = '–¢–∞—Ä–æ ‚Äî –Ω–µ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –º–∞–π–±—É—Ç–Ω—î, –∞ –≤—ñ–¥–∫—Ä–∏–≤–∞—î —Ç–µ, —â–æ –∑–∞–≤–∂–¥–∏ –±—É–ª–æ –ø—Ä–∏—Å—É—Ç–Ω—î, –∞–ª–µ –Ω–µ–≤–∏–¥–∏–º–µ.'

def update_footer_quote(filepath):
    """–û–Ω–æ–≤–ª—é—î —Ü–∏—Ç–∞—Ç—É –≤ —Ñ—É—Ç–µ—Ä—ñ HTML —Ñ–∞–π–ª—É"""

    # –í–∏–∑–Ω–∞—á–∞—î–º–æ –Ω–∞–∑–≤—É —Ä–æ–∑–∫–ª–∞–¥—É –∑ —ñ–º–µ–Ω—ñ —Ñ–∞–π–ª—É
    filename = os.path.basename(filepath).replace('.html', '')
    quote = QUOTES.get(filename, DEFAULT_QUOTE)

    with open(filepath, 'r', encoding='utf-8') as f:
        content = f.read()

    # –®—É–∫–∞—î–º–æ —Ñ—É—Ç–µ—Ä —Ç–∞ –∑–∞–º—ñ–Ω—é—î–º–æ –¥—Ä—É–≥–∏–π <p> –∑ —Ü–∏—Ç–∞—Ç–æ—é
    # –ü–∞—Ç—Ç–µ—Ä–Ω: —Ñ—É—Ç–µ—Ä –∑ –¥–≤–æ–º–∞ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞–º–∏
    pattern = r'(<footer[^>]*>.*?<p[^>]*>.*?</p>\s*<p[^>]*class="text-xs[^"]*">)(.*?)(</p>\s*</footer>)'

    def replacer(match):
        return match.group(1) + quote + match.group(3)

    # –ó–∞–º—ñ–Ω—é—î–º–æ
    new_content = re.sub(pattern, replacer, content, flags=re.DOTALL)

    # –Ø–∫—â–æ –∑–Ω–∞–π—à–ª–∏ —Ç–∞ –∑–∞–º—ñ–Ω–∏–ª–∏
    if new_content != content:
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(new_content)
        print(f'‚úÖ {filename}: "{quote[:50]}..."')
        return True
    else:
        print(f'‚ö†Ô∏è  {filename}: —Ñ—É—Ç–µ—Ä –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∞–±–æ –º–∞—î —ñ–Ω—à–∏–π —Ñ–æ—Ä–º–∞—Ç')
        return False

def main():
    rozklady_dir = '/home/user/evanengell.github.io/rozklady'

    if not os.path.exists(rozklady_dir):
        print(f'‚ùå –ü–∞–ø–∫–∞ {rozklady_dir} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞')
        return

    html_files = [f for f in os.listdir(rozklady_dir) if f.endswith('.html')]

    print(f'üîÆ –î–æ–¥–∞—é —É–Ω—ñ–∫–∞–ª—å–Ω—ñ –≥–Ω–æ—Å—Ç–∏—á–Ω—ñ —Ü–∏—Ç–∞—Ç–∏ –¥–æ {len(html_files)} —Ä–æ–∑–∫–ª–∞–¥—ñ–≤...\n')

    updated = 0
    for filename in sorted(html_files):
        filepath = os.path.join(rozklady_dir, filename)
        if update_footer_quote(filepath):
            updated += 1

    print(f'\n‚ú® –û–Ω–æ–≤–ª–µ–Ω–æ {updated}/{len(html_files)} —Ñ–∞–π–ª—ñ–≤')

if __name__ == '__main__':
    main()
